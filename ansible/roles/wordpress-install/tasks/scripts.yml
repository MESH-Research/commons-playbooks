---

- name: "WordPress Install | create bin directory"
  file:
    dest="{{ www_root }}/{{ item.key }}/bin"
    owner="{{ ansible_ssh_user }}"
    group="{{ ansible_ssh_user }}"
    state="directory"
  with_dict: "wordpress_sites"
  tags:
    - "wordpress-install"

- name: "WordPress Install | commons install script"
  template:
    src="install-commons.sh.j2"
    dest="{{ www_root }}/commons/bin/install-commons.sh"
    owner="{{ ansible_ssh_user }}"
    group="{{ ansible_ssh_user }}"
    mode="0744"
  when: "wordpress_sites.commons is defined"
  tags:
    - "wordpress-install"

- name: "WordPress Install | vanilla install script"
  template:
    src="install-vanilla.sh.j2"
    dest="{{ www_root }}/{{ item.key }}/bin/install-vanilla.sh"
    owner="{{ ansible_ssh_user }}"
    group="{{ ansible_ssh_user }}"
    mode="0744"
  with_dict: "wordpress_sites"
  tags:
    - "wordpress-install"
